<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Notification Example</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', (event) => {
            // Connect to the Socket.IO server
            var socket = io.connect('http://' + document.domain + ':' + location.port, {
                query: 'clinic_id=' + 'your_clinic_id' // Replace with the actual clinic ID
            });

            // Listen for the 'connected' event from the server
            socket.on('connected', function(msg) {
                console.log(msg.message);
            });

            // Listen for 'appointment_notification' events
            socket.on('appointment_notification', function(data) {
                console.log('Appointment notification:', data);
                addNotification(data);
            });

            // Listen for the 'disconnected' event from the server
            socket.on('disconnected', function(msg) {
                console.log(msg.message);
            });

            // Function to add a new notification to the list
            function addNotification(data) {
                var notificationList = document.getElementById('notification-list');
                var notificationCount = document.getElementById('notification-count');
                
                // Create a new list item for the notification
                var newNotification = document.createElement('li');
                newNotification.classList.add('notification-message');

                // Build the notification content
                var notificationContent = `
                    <a href="#">
                        <div class="media">
                            <span class="avatar avatar-sm">
                                <img class="avatar-img rounded-circle" alt="User Image" src="assets/img/doctors/doctor-thumb-01.jpg">
                            </span>
                            <div class="media-body">
                                <p class="noti-details">
                                    <span class="noti-title">Dr. ${data.doctor}</span> has a new appointment on 
                                    <span class="noti-title">${data.date} at ${data.time}</span>
                                </p>
                                <p class="noti-time">
                                    <span class="notification-time">Just now</span>
                                </p>
                            </div>
                        </div>
                    </a>
                `;

                // Insert the notification content into the new list item
                newNotification.innerHTML = notificationContent;
                
                // Prepend the new notification to the notification list
                notificationList.prepend(newNotification);

                // Update the notification count
                var currentCount = parseInt(notificationCount.textContent);
                notificationCount.textContent = currentCount + 1;
            }
        });
    </script>
</head>
<body>
    <ul class="nav navbar-nav navbar-right">
        <!-- Notifications -->
        <li class="nav-item dropdown noti-dropdown">
            <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                <i class="fe fe-bell"></i> <span id="notification-count" class="badge badge-pill">0</span>
            </a>
            <div class="dropdown-menu notifications">
                <div class="topnav-dropdown-header">
                    <span class="notification-title">Notifications</span>
                    <a href="javascript:void(0)" class="clear-noti">Clear All</a>
                </div>
                <div class="noti-content">
                    <ul id="notification-list" class="notification-list">
                        <!-- Existing notifications can be listed here -->
                    </ul>
                </div>
                <div class="topnav-dropdown-footer">
                    <a href="#">View all Notifications</a>
                </div>
            </div>
        </li>
        <!-- /Notifications -->
    </ul>
</body>
</html>
